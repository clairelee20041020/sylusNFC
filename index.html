<!DOCTYPE html>
<html lang="zh-TW">

<head>
  <meta charset="UTF-8">
  <title>秦徹語錄</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <style>
    body {
      margin: 0;
      padding: 0;
      background: linear-gradient(to bottom, #100010, #400010);
      font-family: '微軟正黑體', 'Brush Script MT', cursive, sans-serif;
      color: white;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      position: relative;
    }

    .result-card {
      border-radius: 20px;
      padding: 40px 20px;
      width: 90%;
      max-width: 400px;
      text-align: center;
      background: none;
    }

    .with-background {
      background: #000 !important;
      border-radius: 0 !important;
      box-shadow: none;
    }

    .result-card h2 {
      font-size: 28px;
      margin-bottom: 20px;
      color: #fa8484;
      text-shadow: 0 0 8px #420505;
    }

    .quote {
      font-size: 20px;
      line-height: 1.6;
      color: white;
      margin-bottom: 30px;
      text-shadow: 0 0 4px black;
    }

    .footer {
      font-size: 14px;
      color: #100010;
      position: absolute;
      bottom: 15px;
    }

    .footer.show-in-card {
      position: static;
      margin-top: 20px;
      color: #fa8484;
    }

    button {
      margin-top: 30px;
      font-size: 20px;
      padding: 12px 24px;
      border-radius: 30px;
      border: none;
      background: #ff4c4c;
      color: white;
      box-shadow: 0 0 10px #ff7f7f;
      cursor: pointer;
      z-index: 2;
    }
  </style>
</head>

<body>
  <div class="result-card" id="resultCard">
    <h2>秦徹想對你說</h2>
    <p class="quote" id="quote">（點下面按鈕，讓他親口告訴你）</p>
    <p class="footer show-in-card" id="footerInCard" style="display: none;">© Sylus · 秦徹語錄</p>
  </div>

  <button onclick="showQuote()">他想跟你說</button>
  <button onclick="captureCard()">儲存語錄圖片</button>
  <p class="footer" id="footerBelow">© Sylus · 秦徹語錄</p>

  <audio id="bgm" src="final.mp3" autoplay loop style="display:none"></audio>

  <script>
    // 你的背景圖清單，依據你的 screenshot 路徑排列
    const backgrounds = [
      'bg1.jpg',
      'bg2.jpg',
      'bg3.png',
      'bg4.png',
      'bg5.JPG',
      'bg6.JPG',
      'bg7.jpeg',
      'bg8.jpeg',
      'bg9.jpeg',
      'bg10.jpeg',
      'bg11.jpeg'
    ];

    // 用來記錄目前是哪一張
    let currentBg = -1;

    const quotes = [
      "走吧，我送你回家。",
      "把「出事了先找秦徹」唸三遍吧。",
      "想要散心就隨時打給我，你找的話，我都會有空。",
      "今天的使用權歸你了，還滿意嗎，心上人？",
      "我手上沒有急事，耐心和時間也很充足。你想說的話，我會聽。",
      "累就休息，難過就哭出來，什麽都不想做就不做，我的時間也一起交給你。",
      "在我面前，你永遠有隨心所欲的權利。",
      "新買了幾張唱片，和一瓶好酒，都在等你。",
      "除了你，還有誰能把我怎麽樣？",
      "沒有什麽比靠自己調整好的狀態更有力量，相信自己的能力。",
      "別回家睡覺了，晚上和我騎車出去兜風。",
      "一旦我們雙手相握，從此就生死與共了。",
      "在我這裡，你不需要遮掩，我也可以是那個幫你搔肚皮的人。",
      "我忙或不忙，都不影響我視訊看你"
    ];

    const birthdayQuote = "願你永遠活得恣意且熱烈，這就是我的生日願望。";

    window.onload = changeBg; // show one background image when first come in

    function showQuote() {
      const quote = Math.random() < 0.05 ? birthdayQuote : quotes[Math.floor(Math.random() * quotes.length)];
      document.getElementById("quote").innerText = quote;

      const bgm = document.getElementById('bgm');
      if (bgm.paused) {
        bgm.play().catch(() => { });
      }

      changeBg(); // change background image at every click
    }

    function captureCard() {
      const card = document.getElementById("resultCard");
      const footer = document.getElementById("footerInCard");
      const pageFooter = document.getElementById("footerBelow");

      // 顯示內部 footer、加背景
      footer.style.display = 'block';
      card.classList.add("with-background");
      pageFooter.style.display = 'none';

      html2canvas(card).then(canvas => {
        const link = document.createElement('a');
        link.download = '秦徹語錄.png';
        link.href = canvas.toDataURL();
        link.click();

        // 還原
        footer.style.display = 'none';
        card.classList.remove("with-background");
        pageFooter.style.display = 'block';
      });
    }
  </script>
</body>

</html>